---
title: "seacarb constant compairason"
author: "Nick Decker"
date: "2023-10-17"
output: 
  html_document
---

r setup
```{r setup, include= FALSE}
library(tidyverse)
library(seacarb)
library(janitor)
library(here)
library(readxl)
library(writexl)
library(knitr)
library(ggplot2)
```

load data
```{r}
cleaned_baysys_data <- read_excel(here("BaySys Data/cleaned_baysys_data.xlsx"))
```

Lueker et al. (2000)
```{r, echo = FALSE}

baysysleuker <- carb(flag = "15",
                    cleaned_baysys_data$var1,
                    cleaned_baysys_data$var2,
                    cleaned_baysys_data$s,
                    cleaned_baysys_data$t,
                    (cleaned_baysys_data$Patm)/101.3, # divided by 101.3 for unit conversion
                    (cleaned_baysys_data$p)/10, # divided by 1000 for unit conversion
                    Pt=0,
                    Sit=0,
                    k1k2 = "l", # K1 and K2 from Lueker et al. (2000)
                    kf="dg", # Dickson and Riley (1979)
                    ks="d", # Dickson (1990)
                    pHscale="T", # Total Scale
                    b="l10", # Lee et al. (2010)
                    warn="n", # Shows warnings if T or S are out of range
                    eos="eos80", 
                    cleaned_baysys_data$long,
                    cleaned_baysys_data$lat) %>% 
  mutate(sid = cleaned_baysys_data$sid) %>% 
  select(sid, everything()) %>% 
  select(everything(), -flag) %>% 
  clean_names()

baysysleuker %>% 
  ggplot(aes(x = t, y = p_co2insitu)) +
  geom_smooth(method = "lm", colour = "red", linewidth = 0.75) +
  geom_point() +
  xlab("Temperature (c)") +
  ylab("pco2 (in-situ)") +
  theme_classic()
```


Millero et al. (2010)
```{r, echo = FALSE}
baysysmillero2010 <- carb(flag = "15",
                    cleaned_baysys_data$var1,
                    cleaned_baysys_data$var2,
                    cleaned_baysys_data$s,
                    cleaned_baysys_data$t,
                    (cleaned_baysys_data$Patm)/101.3, # divided by 101.3 for unit conversion
                    (cleaned_baysys_data$p)/10, # divided by 10 for unit conversion
                    Pt=0,
                    Sit=0,
                    k1k2 = "m10", # K1 and K2 from Millero et al. (2010)
                    kf="dg", # Dickson and Riley (1979)
                    ks="d", # Dickson (1990)
                    pHscale="T", # Total Scale
                    b="l10", # Lee et al. (2010)
                    warn="n", # Shows warnings if T or S are out of range
                    eos="teos10", 
                    cleaned_baysys_data$long,
                    cleaned_baysys_data$lat) %>% 
  mutate(sid = cleaned_baysys_data$sid) %>% 
  select(sid, everything()) %>% 
  select(everything(), -flag) %>% 
  clean_names()

baysysmillero2010 %>% 
  ggplot(aes(x = t, y = p_co2insitu)) +
  geom_smooth(method = "lm", colour = "yellow", linewidth = 0.75) +
  geom_point() +
  xlab("Temperature (c)") +
  ylab("pco2 (in-situ)") +
  theme_classic()
```




The calculated data from each instance on the same chart
```{r, echo = FALSE}
ggplot() +
  geom_smooth(data = baysysleuker, 
              aes(x = t, y = p_co2insitu),
              method = "lm", 
              color = "red", 
              linewidth = 0.75) +
  geom_smooth(data = baysysmillero2010, 
              aes(x = t, y = p_co2insitu),
              method = "lm", 
              color = "blue", 
              linewidth = 0.75) +
  xlab("Temperature (c)") +
  ylab("pco2 (in-situ)") +
  theme_classic()
```